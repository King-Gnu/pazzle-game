<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>1筆書きマスパズル</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>1筆書きマスパズル</h1>
    <button id="rule-btn">📖 ルール</button>
    <div id="game-container">
        <div id="controls">
            <label for="size-select">盤面サイズ:</label>
            <select id="size-select">
                <option value="6" selected>6×6</option>
                <option value="7">7×7</option>
                <option value="8">8×8</option>
                <option value="9">9×9</option>
                <option value="10">10×10</option>
            </select>
            <label for="obstacle-input">お邪魔マス数:</label>
            <input type="number" id="obstacle-input" min="0" value="0" />
            <span id="obstacle-max"></span>
            <button id="regenerate-btn">次の問題</button>
            <button id="generate-with-settings-btn">この設定で生成</button>
        </div>
        <div id="difficulty-display">
            <span id="difficulty-label">難易度:</span>
            <span id="difficulty-value">-</span>
            <div id="difficulty-bar">
                <div id="difficulty-fill"></div>
            </div>
        </div>
        <canvas id="board" width="600" height="600"></canvas>
        <div id="ui">
            <button id="reset-btn">リセット</button>
            <button id="hint-btn">クリアルート表示</button>
            <span id="message"></span>
        </div>
        <div id="share-controls">
            <button id="copy-puzzle-btn">📋 問題コードをコピー</button>
            <button id="load-puzzle-btn">📥 問題コードを入力</button>
        </div>
    </div>

    <!-- クリアルート表示用のモーダル -->
    <div id="solution-modal" style="display:none;">
        <div id="solution-overlay"></div>
        <div id="solution-content">
            <h2>クリアルート</h2>
            <canvas id="solution-canvas" width="400" height="400"></canvas>
            <div id="solution-info"></div>
            <button id="close-modal-btn">閉じる</button>
        </div>
    </div>

    <!-- 問題共有用モーダル -->
    <div id="share-modal" style="display:none;">
        <div id="share-overlay"></div>
        <div id="share-content">
            <h2 id="share-modal-title">問題コード</h2>
            <textarea id="share-code-input" rows="3" placeholder="問題コードを入力..."></textarea>
            <div id="share-modal-buttons">
                <button id="share-copy-btn">コピー</button>
                <button id="share-load-btn">読み込み</button>
                <button id="share-close-btn">閉じる</button>
            </div>
        </div>
    </div>

    <!-- ルール表示用モーダル -->
    <div id="rule-modal" style="display:none;">
        <div id="rule-overlay"></div>
        <div id="rule-content">
            <h2>📖 ルール</h2>
            <div id="rule-text">
                <p><strong>目的:</strong></p>
                <p>スタート（<span class="rule-start">S</span>）からゴール（<span class="rule-goal">G</span>）まで、すべての白いマスを<strong>一筆書き</strong>で通ってください。</p>
                
                <p><strong>ルール:</strong></p>
                <ul>
                    <li>上下左右に隣接するマスに移動できます（斜めはNG）</li>
                    <li>同じマスを2度通ることはできません</li>
                    <li>灰色の<strong>お邪魔マス（☒）</strong>は通れません</li>
                    <li>すべての白いマスを通らないとクリアできません</li>
                </ul>
                
                <p><strong>操作:</strong></p>
                <ul>
                    <li><strong>PC:</strong> マウスをドラッグして線を引く</li>
                    <li><strong>スマホ:</strong> 指でなぞって線を引く</li>
                    <li>線を戻すこともできます（来た道を逆になぞる）</li>
                </ul>
            </div>
            <button id="close-rule-btn">閉じる</button>
        </div>
    </div>

    <script src="main.js"></script>
</body>

</html>